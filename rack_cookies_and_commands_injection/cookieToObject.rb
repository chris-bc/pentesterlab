class User
end

require "data_mapper"
require "net/http"
require "uri"
require "pp"
require "base64"

# Reote host
URL = "http://192.168.88.193/login"

# Create URL
url = URI.parse(URL)

# Proxy config
PROXY = "127.0.0.1"
PROXY_PORT = "8080"

creds = "test"

# Auth
resp = Net::HTTP::Proxy(PROXY, PROXY_PORT).start(url.host, url.port) do |http|
	http.post(url.request_uri, "login=#{creds}&password=#{creds}")
end

# Get the cookie
c = resp.header['Set-Cookie'].split("=")[1].split("; ")[0]
cookie, signature = c.split("--")
decoded = Base64.decode64(URI.decode(cookie))
begin
	# Load object
	object = Marshal.load(decoded)
	pp object
rescue ArgumentError => e
	puts "ERROR: " + e.to_s
end

